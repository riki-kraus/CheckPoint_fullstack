/**
 * @preserve
 * Kevin Frankot - react-hook-form-yup v1.0.0
 */
import e,{createContext as o,useMemo as n,useContext as t,useCallback as r}from"react";import{useFormContext as a,useController as l,FormProvider as c,useForm as m}from"react-hook-form";import{useCallbackRef as s}from"@radix-ui/react-use-callback-ref";import{flatten as i}from"flat";import{SchemaProvider as d,useFieldProps as h}from"yup-field-props-react";import{yupResolver as u}from"@hookform/resolvers/yup";const S=o({schemaSyncMode:!1,disableValidateOnSchemaSync:!1,trigger:()=>Promise.resolve(!1)}),f=({schema:o,schemaSyncMode:t,disableValidateOnSchemaSync:r,children:l})=>{const c=a(),{formState:{submitCount:m}}=c,h=c.control._options.mode,u=c.control._options.reValidateMode,f=null!=t?t:"onBlur",g=null!=r?r:"onSubmit"===(m>0?null!=u?u:"onChange":null!=h?h:"onSubmit"),p=s((()=>{var e,o;const n="all"===f||"onChange"===f||"onTouched"===f,t=e=>{const o=i(e);return Object.keys(o).filter((e=>o[e]))},r="all"===f||"onTouched"===f||"onBlur"===f?t(null!==(e=c.formState.touchedFields)&&void 0!==e?e:{}):[],a=n?t(null!==(o=c.formState.dirtyFields)&&void 0!==o?o:{}):[],l=r.length&&a.length?[...new Set([...r,...a])]:[...r,...a];return c.trigger(l)})),y=n((()=>({schemaSyncMode:f,disableValidateOnSchemaSync:g,trigger:p})),[f,g,p]);return e.createElement(S.Provider,{value:y},e.createElement(d,{schema:o,values:c.getValues,context:c.control._options.context},l))},g=()=>t(S),p=(e,o)=>{const t=h(e),{schemaSyncMode:a,disableValidateOnSchemaSync:l,trigger:c}=g(),m="onTouched"===a||"onChange"===a||"all"===a?o.isTouched:null,s=[m,a,l,c,t.forceFormUpdate],i=r((()=>{("onChange"===a||"all"===a||"onTouched"===a&&m)&&(t.forceFormUpdate(),l||c())}),[...s]),d=r((()=>{"onBlur"!==a&&"onTouched"!==a&&"all"!==a||(t.forceFormUpdate(),l||c())}),[...s]);return n((()=>({onChange:i,onBlur:d,schemaState:t})),[i,d,t])},y=({name:e,...o})=>{const{field:t,fieldState:a,formState:c}=l({name:e,...o}),{onChange:m,onBlur:s,schemaState:i}=p(e,a),d=r(((...e)=>{t.onChange(...e),m()}),[t.onChange,m]),h=r((()=>{t.onBlur(),s()}),[t.onBlur,s]);return n((()=>({field:{...t,onChange:d,onBlur:h},fieldState:a,formState:c,schemaState:i})),[t,a,c,d,h,i])},b=e=>{const o=y(e);return e.render(o)},v=({schema:o,schemaSyncMode:n,disableValidateOnSchemaSync:t,children:r,...a})=>e.createElement(c,a,e.createElement(f,{schema:o,schemaSyncMode:n,disableValidateOnSchemaSync:t},r)),C=({schema:e,schemaOptions:o,resolverOptions:t,...r})=>{const a=n((()=>u(e,o,t)),[e,o,t]),l=m({...r,resolver:a});return n((()=>({...l,schema:e})),[l,l.formState,e])};export{b as Controller,v as FormProvider,S as SchemaConfigsContext,f as SchemaConfigsProvider,y as useController,C as useForm,g as useSchemaConfigs,p as useSchemaController};
