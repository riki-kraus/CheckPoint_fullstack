/**
 * @preserve
 * Kevin Frankot - yup-field-props-base v1.0.0
 */
"use strict";var e=require("yup");const t=(e,t,a)=>{if(t)throw e;return console.warn(e),a},a=(e,t)=>{const a=t.toString().split(".");let r=e;for(let e of a){if(!r)return;r=r[e]}return r},r=e=>!("number"!=typeof e||Number.isNaN(e)||!Number.isFinite(e))||"string"==typeof e&&!Number.isNaN(Number(e)),n=e=>{const t=e.split("."),a=t.slice(0,t.length-1).join(".");return{valuePath:t[t.length-1],parentPath:a}},s=({name:r,schema:s,values:o,context:c,throwError:i=!1})=>{try{const{valuePath:t,parentPath:i}=n(r),u=i?a(o,i):o,l=a(u,t);return e.reach(s,r,o,c).describe({value:l,parent:u,context:c})}catch(e){return t(e,i,null)}},o=["key","isContext","isValue","isSibling","path"],c=({param:e,values:t,name:r,context:n})=>{const s=e&&"object"==typeof e,c=!!s&&o.every((t=>Object.hasOwn(e,t))),i=s&&("ref"===e.type||c&&"function"!=typeof e.getValue);if(c&&"function"==typeof e.getValue)try{const s=e;let o;if(s.isContext)o=t;else{const e=r.split(".").slice(0,-1).join(".");o=e?a(t,e):t}return s.getValue(t,o,n)}catch(e){return void console.debug("Error parsing ref class, fallback on undefined",e)}else if(i)try{const r=e;return a(t,r.path||r.key)}catch(e){return void console.debug("Error parsing basic ref, fallback on undefined",e)}return e},i=({param:e,values:t,name:a,context:r,key:n,typeCheck:s,toStrictType:o})=>{const i=c({param:e,values:t,name:a,context:r});return void 0===i?{}:(e=>e?"string"==typeof e?t=>typeof t===e:e:()=>!0)(s)(i)?{[n]:o?o(i):i}:{}},u=({test:e,values:t,name:a,context:n})=>{var s,o,c,u;switch(e.name){case"min":case"max":case"length":return i({param:null===(s=e.params)||void 0===s?void 0:s[e.name],values:t,name:a,context:n,key:e.name,typeCheck:r,toStrictType:Number});case"matches":return i({param:null===(o=e.params)||void 0===o?void 0:o.regex,values:t,name:a,context:n,key:"matches",typeCheck:e=>e instanceof RegExp});case"email":return{email:!0};case"url":return{url:!0};case"uuid":return{uuid:!0};case"datetime":return{datetime:!0};case"datetime_offset":return i({param:null===(c=e.params)||void 0===c?void 0:c.allowOffset,values:t,name:a,context:n,key:"datetimeAllowOffset",typeCheck:"boolean"});case"datetime_precision":return i({param:null===(u=e.params)||void 0===u?void 0:u.precision,values:t,name:a,context:n,key:"datetimePrecision",typeCheck:r,toStrictType:Number});default:return null}},l=({test:e,values:t,name:a,context:n})=>{var s,o,c,u;switch(e.name){case"min":return void 0!==(null===(s=e.params)||void 0===s?void 0:s.min)?i({param:e.params.min,values:t,name:a,context:n,key:"min",typeCheck:r,toStrictType:Number}):void 0!==(null===(o=e.params)||void 0===o?void 0:o.more)?i({param:e.params.more,values:t,name:a,context:n,key:"moreThan",typeCheck:r,toStrictType:Number}):{};case"max":return void 0!==(null===(c=e.params)||void 0===c?void 0:c.max)?i({param:e.params.max,values:t,name:a,context:n,key:"max",typeCheck:r,toStrictType:Number}):void 0!==(null===(u=e.params)||void 0===u?void 0:u.less)?i({param:e.params.less,values:t,name:a,context:n,key:"lessThan",typeCheck:r,toStrictType:Number}):{};case"integer":return{integer:!0};default:return null}},m=({test:e,values:t,name:a,context:n})=>{var s;switch(e.name){case"min":case"max":case"length":return i({param:null===(s=e.params)||void 0===s?void 0:s[e.name],values:t,name:a,context:n,key:e.name,typeCheck:r,toStrictType:Number});default:return null}},p=({test:e,values:t,name:a,context:r})=>{switch(e.name){case"min":case"max":{var n;const s=c({param:null===(n=e.params)||void 0===n?void 0:n[e.name],values:t,name:a,context:r}),o=new Date(s);return(e=>e instanceof Date&&!isNaN(e.getTime()))(o)?{[e.name]:o}:{}}default:return null}},d=()=>({type:"mixed",required:!1,nullable:!1,oneOf:[],notOneOf:[],description:e.mixed().describe(),tests:[]}),v=({name:e,fieldDescription:a,values:r,context:n,throwError:s=!1})=>{if(!a&&!s)return console.warn("No field description found for",e),d();try{const t=a.type,s={type:t,required:!a.optional,nullable:a.nullable,oneOf:a.oneOf.map((t=>c({param:t,values:r,name:e,context:n}))),notOneOf:a.notOneOf.map((t=>c({param:t,values:r,name:e,context:n}))),default:c({param:a.default,values:r,name:e,context:n}),description:a,tests:a.tests};void 0===s.default&&delete s.default;const o=(e=>{switch(e){case"string":return u;case"array":return m;case"number":return l;case"date":return p;default:return null}})(t);if(!o)return s;const i=[];if(a.tests.forEach((t=>{if(!(e=>!!e.name)(t))return;const a=o({name:e,test:t,values:r,context:n});a&&Object.assign(s,a),null===a&&i.push(t)})),i.forEach((t=>{var a;if(Object.hasOwn(s,t.name||""))return;let o=t.params&&"object"==typeof t.params?{...t.params}:t.params;o&&"object"==typeof o?Object.keys(o).forEach((t=>{o[t]=c({param:o[t],values:r,name:e,context:n})})):o=c({param:o,values:r,name:e,context:n}),Object.assign(s,{[t.name||""]:null===(a=o)||void 0===a||a})})),"array"===t){const t=a.innerType;t&&!Array.isArray(t)&&(s.of=v({name:e+"[]",fieldDescription:t,values:r,context:n}))}return s}catch(e){return t(e,s,d())}};exports.getFieldDescription=s,exports.getFieldDescriptionFromPaths=({valuePath:r,parentPath:n,schema:s,values:o,context:c,throwError:i=!1})=>{try{const t=n?a(o,n):o,i=a(t,r);return e.reach(s,n?n+"."+r:r,o,c).describe({value:i,parent:t,context:c})}catch(e){return t(e,i,null)}},exports.getFieldPathsFromName=n,exports.getFieldProps=({name:e,schema:t,values:a,context:r,throwError:n=!1})=>{const o=s({name:e,schema:t,values:a,context:r,throwError:n});return v({name:e,fieldDescription:o,values:a,context:r,throwError:n})},exports.getFieldPropsFromDescription=v;
