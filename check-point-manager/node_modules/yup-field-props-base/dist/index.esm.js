/**
 * @preserve
 * Kevin Frankot - yup-field-props-base v1.0.0
 */
import{reach as e,mixed as t}from"yup";const a=(e,t,a)=>{if(t)throw e;return console.warn(e),a},r=(e,t)=>{const a=t.toString().split(".");let r=e;for(let e of a){if(!r)return;r=r[e]}return r},n=e=>!("number"!=typeof e||Number.isNaN(e)||!Number.isFinite(e))||"string"==typeof e&&!Number.isNaN(Number(e)),s=e=>{const t=e.split("."),a=t.slice(0,t.length-1).join(".");return{valuePath:t[t.length-1],parentPath:a}},o=({name:t,schema:n,values:o,context:c,throwError:u=!1})=>{try{const{valuePath:a,parentPath:u}=s(t),i=u?r(o,u):o,l=r(i,a);return e(n,t,o,c).describe({value:l,parent:i,context:c})}catch(e){return a(e,u,null)}},c=({valuePath:t,parentPath:n,schema:s,values:o,context:c,throwError:u=!1})=>{try{const a=n?r(o,n):o,u=r(a,t);return e(s,n?n+"."+t:t,o,c).describe({value:u,parent:a,context:c})}catch(e){return a(e,u,null)}},u=["key","isContext","isValue","isSibling","path"],i=({param:e,values:t,name:a,context:n})=>{const s=e&&"object"==typeof e,o=!!s&&u.every((t=>Object.hasOwn(e,t))),c=s&&("ref"===e.type||o&&"function"!=typeof e.getValue);if(o&&"function"==typeof e.getValue)try{const s=e;let o;if(s.isContext)o=t;else{const e=a.split(".").slice(0,-1).join(".");o=e?r(t,e):t}return s.getValue(t,o,n)}catch(e){return void console.debug("Error parsing ref class, fallback on undefined",e)}else if(c)try{const a=e;return r(t,a.path||a.key)}catch(e){return void console.debug("Error parsing basic ref, fallback on undefined",e)}return e},l=({param:e,values:t,name:a,context:r,key:n,typeCheck:s,toStrictType:o})=>{const c=i({param:e,values:t,name:a,context:r});return void 0===c?{}:(e=>e?"string"==typeof e?t=>typeof t===e:e:()=>!0)(s)(c)?{[n]:o?o(c):c}:{}},m=({test:e,values:t,name:a,context:r})=>{var s,o,c,u;switch(e.name){case"min":case"max":case"length":return l({param:null===(s=e.params)||void 0===s?void 0:s[e.name],values:t,name:a,context:r,key:e.name,typeCheck:n,toStrictType:Number});case"matches":return l({param:null===(o=e.params)||void 0===o?void 0:o.regex,values:t,name:a,context:r,key:"matches",typeCheck:e=>e instanceof RegExp});case"email":return{email:!0};case"url":return{url:!0};case"uuid":return{uuid:!0};case"datetime":return{datetime:!0};case"datetime_offset":return l({param:null===(c=e.params)||void 0===c?void 0:c.allowOffset,values:t,name:a,context:r,key:"datetimeAllowOffset",typeCheck:"boolean"});case"datetime_precision":return l({param:null===(u=e.params)||void 0===u?void 0:u.precision,values:t,name:a,context:r,key:"datetimePrecision",typeCheck:n,toStrictType:Number});default:return null}},p=({test:e,values:t,name:a,context:r})=>{var s,o,c,u;switch(e.name){case"min":return void 0!==(null===(s=e.params)||void 0===s?void 0:s.min)?l({param:e.params.min,values:t,name:a,context:r,key:"min",typeCheck:n,toStrictType:Number}):void 0!==(null===(o=e.params)||void 0===o?void 0:o.more)?l({param:e.params.more,values:t,name:a,context:r,key:"moreThan",typeCheck:n,toStrictType:Number}):{};case"max":return void 0!==(null===(c=e.params)||void 0===c?void 0:c.max)?l({param:e.params.max,values:t,name:a,context:r,key:"max",typeCheck:n,toStrictType:Number}):void 0!==(null===(u=e.params)||void 0===u?void 0:u.less)?l({param:e.params.less,values:t,name:a,context:r,key:"lessThan",typeCheck:n,toStrictType:Number}):{};case"integer":return{integer:!0};default:return null}},v=({test:e,values:t,name:a,context:r})=>{var s;switch(e.name){case"min":case"max":case"length":return l({param:null===(s=e.params)||void 0===s?void 0:s[e.name],values:t,name:a,context:r,key:e.name,typeCheck:n,toStrictType:Number});default:return null}},d=({test:e,values:t,name:a,context:r})=>{switch(e.name){case"min":case"max":{var n;const s=i({param:null===(n=e.params)||void 0===n?void 0:n[e.name],values:t,name:a,context:r}),o=new Date(s);return(e=>e instanceof Date&&!isNaN(e.getTime()))(o)?{[e.name]:o}:{}}default:return null}},f=()=>({type:"mixed",required:!1,nullable:!1,oneOf:[],notOneOf:[],description:t().describe(),tests:[]}),y=({name:e,fieldDescription:t,values:r,context:n,throwError:s=!1})=>{if(!t&&!s)return console.warn("No field description found for",e),f();try{const a=t.type,s={type:a,required:!t.optional,nullable:t.nullable,oneOf:t.oneOf.map((t=>i({param:t,values:r,name:e,context:n}))),notOneOf:t.notOneOf.map((t=>i({param:t,values:r,name:e,context:n}))),default:i({param:t.default,values:r,name:e,context:n}),description:t,tests:t.tests};void 0===s.default&&delete s.default;const o=(e=>{switch(e){case"string":return m;case"array":return v;case"number":return p;case"date":return d;default:return null}})(a);if(!o)return s;const c=[];if(t.tests.forEach((t=>{if(!(e=>!!e.name)(t))return;const a=o({name:e,test:t,values:r,context:n});a&&Object.assign(s,a),null===a&&c.push(t)})),c.forEach((t=>{var a;if(Object.hasOwn(s,t.name||""))return;let o=t.params&&"object"==typeof t.params?{...t.params}:t.params;o&&"object"==typeof o?Object.keys(o).forEach((t=>{o[t]=i({param:o[t],values:r,name:e,context:n})})):o=i({param:o,values:r,name:e,context:n}),Object.assign(s,{[t.name||""]:null===(a=o)||void 0===a||a})})),"array"===a){const a=t.innerType;a&&!Array.isArray(a)&&(s.of=y({name:e+"[]",fieldDescription:a,values:r,context:n}))}return s}catch(e){return a(e,s,f())}},h=({name:e,schema:t,values:a,context:r,throwError:n=!1})=>{const s=o({name:e,schema:t,values:a,context:r,throwError:n});return y({name:e,fieldDescription:s,values:a,context:r,throwError:n})};export{o as getFieldDescription,c as getFieldDescriptionFromPaths,s as getFieldPathsFromName,h as getFieldProps,y as getFieldPropsFromDescription};
